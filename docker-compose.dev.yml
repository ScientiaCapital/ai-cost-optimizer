services:
  postgres:
    extends:
      file: docker-compose.yml
      service: postgres
    ports:
      - "5433:5432"  # Different port for dev

  api:
    extends:
      file: docker-compose.yml
      service: api
    volumes:
      - ./app:/app/app  # Mount for hot reload
      - ./tests:/app/tests
    environment:
      LOG_LEVEL: DEBUG
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

volumes:
  postgres_data:
    driver: local

networks:
  optimizer-network:
    driver: bridge
